import{_ as w}from"./index.CYHJt075.js";import{m as f}from"./alpine.CJ7ePfyg.js";import{a as y}from"./http.NIGUFBhG.js";import{P as g,E as v}from"./realtime.gXXUreaj.js";import"./components.C67tSh7_.js";import"./app-utils.ChIKtZRd.js";import"./charts.CVV2ciRB.js";import"./vendor.D8fDXNIl.js";window.axios=y;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const p=document.head.querySelector('meta[name="csrf-token"]');p?window.axios.defaults.headers.common["X-CSRF-TOKEN"]=p.content:console.error("CSRF token not found: https://laravel.com/docs/csrf#csrf-x-csrf-token");window.Pusher=g;window.Echo=new v({broadcaster:"pusher",key:"hd-tickets-key",cluster:"",forceTLS:!0});class S{constructor({contentSelector:e="main",transition:t="fade",cacheSize:s=10}={}){this.container=document.querySelector(e),this.transition=t,this.cache=new Map,this.cacheOrder=[],this.cacheSize=s,this.prefetchLinks(),this.bindClicks(),this.bindPopstate()}prefetchLinks(){document.querySelectorAll('a[href^="/"]:not([data-no-prefetch])').forEach(t=>{t.addEventListener("mouseenter",()=>this.prefetch(t.href),{passive:!0}),t.addEventListener("touchstart",()=>this.prefetch(t.href),{passive:!0})})}async prefetch(e){if(!this.cache.has(e))try{const t=await fetch(e,{headers:{"X-Prefetch":"1"},credentials:"same-origin"});if(!t.ok)return;const s=await t.text();this.saveCache(e,s)}catch{}}bindClicks(){document.addEventListener("click",e=>{const t=e.target.closest("a");if(!t)return;const s=new URL(t.href,location.origin);s.origin===location.origin&&(t.target==="_blank"||t.hasAttribute("download")||t.dataset.noSpa==="true"||(e.preventDefault(),this.navigate(s.pathname+s.search+s.hash,{push:!0})))})}bindPopstate(){window.addEventListener("popstate",()=>{this.navigate(location.pathname+location.search+location.hash,{push:!1})})}async navigate(e,{push:t=!0}={}){try{let s=this.cache.get(e);s||(s=await(await fetch(e,{headers:{"X-Partial":"1"},credentials:"same-origin"})).text(),this.saveCache(e,s)),t&&history.pushState({},"",e),this.swapContent(s),this.updateActiveNav(e),this.scrollRestore()}catch{location.href=e}}saveCache(e,t){if(this.cache.set(e,t),this.cacheOrder.push(e),this.cacheOrder.length>this.cacheSize){const s=this.cacheOrder.shift();this.cache.delete(s)}}swapContent(e){if(!this.container)return;const t=document.createElement("template");t.innerHTML=e.trim();const s=t.content.querySelector("main");if(!s){this.container.innerHTML=e;return}this.animateOut(this.container,()=>{this.container.replaceWith(s),this.container=s,this.animateIn(this.container),document.dispatchEvent(new CustomEvent("route:changed"))})}animateOut(e,t){this.transition==="slide"?(e.style.transition="transform 200ms ease, opacity 200ms ease",e.style.transform="translateX(10px)",e.style.opacity="0.001",setTimeout(t,200)):(e.style.transition="opacity 120ms ease",e.style.opacity="0.001",setTimeout(t,120))}animateIn(e){requestAnimationFrame(()=>{e.style.transition="none",e.style.opacity="0.001",e.style.transform="translateX(0)",requestAnimationFrame(()=>{e.style.transition="opacity 160ms ease",e.style.opacity="1"})})}updateActiveNav(e){document.querySelectorAll("nav a").forEach(t=>{try{new URL(t.href).pathname===new URL(e,location.origin).pathname?t.classList.add("text-indigo-600"):t.classList.remove("text-indigo-600")}catch{}})}scrollRestore(){"scrollRestoration"in history&&(history.scrollRestoration="manual"),window.scrollTo({top:0,behavior:"instant"})}}class E{constructor(){this.syncTags={TICKET_ALERTS:"ticket-alerts-sync",PRICE_UPDATES:"price-updates-sync",USER_PREFERENCES:"user-preferences-sync",PURCHASE_QUEUE:"purchase-queue-sync",WATCHLIST_SYNC:"watchlist-sync",ANALYTICS_SYNC:"analytics-sync"},this.endpoints={alerts:"/api/sync/alerts",prices:"/api/sync/prices",preferences:"/api/sync/preferences",purchases:"/api/sync/purchases",watchlist:"/api/sync/watchlist",analytics:"/api/sync/analytics"},this.syncIntervals=new Map,this.retryAttempts=new Map,this.maxRetries=3,this.init()}async init(){if(!("serviceWorker"in navigator)||!("sync"in window.ServiceWorkerRegistration.prototype)){console.warn("Background Sync not supported, falling back to periodic sync"),this.initPeriodicSync();return}try{const e=await navigator.serviceWorker.ready;this.registration=e,this.initEventListeners(),console.log("Background Sync Manager initialized")}catch(e){console.error("Failed to initialize Background Sync:",e),this.initPeriodicSync()}}initEventListeners(){document.addEventListener("data:changed",e=>{this.scheduleSync(e.detail.type,e.detail.data)}),window.addEventListener("online",()=>{this.onNetworkStatusChange(!0)}),window.addEventListener("offline",()=>{this.onNetworkStatusChange(!1)}),document.addEventListener("visibilitychange",()=>{document.hidden||this.syncCriticalData()}),document.addEventListener("sync:request",e=>{this.scheduleSync(e.detail.tag,e.detail.data)})}async scheduleSync(e,t={}){if(!this.registration){console.warn("Service worker not available, storing for later sync"),await this.storeForLaterSync(e,t);return}try{const s=this.getSyncTag(e);t&&Object.keys(t).length>0&&await this.storeSyncData(s,t),await this.registration.sync.register(s),console.log(`Scheduled background sync: ${s}`),navigator.onLine&&this.attemptImmediateSync(e,t)}catch(s){console.error("Failed to schedule background sync:",s),await this.storeForLaterSync(e,t)}}getSyncTag(e){return{"ticket-alerts":this.syncTags.TICKET_ALERTS,"price-updates":this.syncTags.PRICE_UPDATES,"user-preferences":this.syncTags.USER_PREFERENCES,"purchase-queue":this.syncTags.PURCHASE_QUEUE,watchlist:this.syncTags.WATCHLIST_SYNC,analytics:this.syncTags.ANALYTICS_SYNC}[e]||e}async storeSyncData(e,t){try{const s={tag:e,data:t,timestamp:Date.now(),retries:0};localStorage.setItem(`sync_${e}`,JSON.stringify(s))}catch(s){console.error("Failed to store sync data:",s)}}async storeForLaterSync(e,t){try{const s=JSON.parse(localStorage.getItem("pending_sync")||"[]");s.push({type:e,data:t,timestamp:Date.now()}),localStorage.setItem("pending_sync",JSON.stringify(s))}catch(s){console.error("Failed to store pending sync:",s)}}async attemptImmediateSync(e,t={}){try{const s=this.getEndpoint(e);if(!s)return;const i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content||""},credentials:"same-origin",body:JSON.stringify(t)});if(i.ok)console.log(`Immediate sync successful: ${e}`),this.clearSyncData(this.getSyncTag(e)),this.notifyUI("sync:success",{type:e,timestamp:Date.now()});else throw new Error(`Sync failed: ${i.status}`)}catch(s){console.error(`Immediate sync failed for ${e}:`,s)}}getEndpoint(e){return{"ticket-alerts":this.endpoints.alerts,"price-updates":this.endpoints.prices,"user-preferences":this.endpoints.preferences,"purchase-queue":this.endpoints.purchases,watchlist:this.endpoints.watchlist,analytics:this.endpoints.analytics}[e]}clearSyncData(e){try{localStorage.removeItem(`sync_${e}`)}catch(t){console.error("Failed to clear sync data:",t)}}async onNetworkStatusChange(e){e?(console.log("Network restored, processing pending syncs"),await this.processPendingSyncs(),this.notifyUI("network:online",{timestamp:Date.now()})):(console.log("Network lost, enabling offline mode"),this.notifyUI("network:offline",{timestamp:Date.now()}))}async processPendingSyncs(){try{const e=JSON.parse(localStorage.getItem("pending_sync")||"[]");for(const t of e)await this.scheduleSync(t.type,t.data);localStorage.removeItem("pending_sync"),console.log(`Processed ${e.length} pending syncs`)}catch(e){console.error("Failed to process pending syncs:",e)}}async syncCriticalData(){const e=["ticket-alerts","price-updates","watchlist"];console.log("Syncing critical data...");for(const t of e)await this.scheduleSync(t)}initPeriodicSync(){console.log("Initializing periodic sync fallback"),this.syncIntervals.set("critical",setInterval(()=>{navigator.onLine&&!document.hidden&&this.syncCriticalData()},120*1e3)),this.syncIntervals.set("user",setInterval(()=>{navigator.onLine&&!document.hidden&&(this.scheduleSync("user-preferences"),this.scheduleSync("analytics"))},300*1e3)),this.syncIntervals.set("background",setInterval(()=>{navigator.onLine&&this.scheduleSync("purchase-queue")},600*1e3))}async syncTicketAlerts(e={}){return this.scheduleSync("ticket-alerts",e)}async syncPriceUpdates(e={}){return this.scheduleSync("price-updates",e)}async syncUserPreferences(e={}){return this.scheduleSync("user-preferences",e)}async syncWatchlist(e={}){return this.scheduleSync("watchlist",e)}async syncPurchaseQueue(e={}){return this.scheduleSync("purchase-queue",e)}async syncAnalytics(e={}){return this.scheduleSync("analytics",e)}async forceSyncAll(){console.log("Force syncing all data...");const t=["ticket-alerts","price-updates","user-preferences","watchlist","purchase-queue","analytics"].map(s=>this.scheduleSync(s));await Promise.allSettled(t),console.log("Force sync completed")}notifyUI(e,t={}){document.dispatchEvent(new CustomEvent(e,{detail:t}))}destroy(){this.syncIntervals.forEach(e=>clearInterval(e)),this.syncIntervals.clear(),console.log("Background Sync Manager destroyed")}getSyncStatus(){const e=JSON.parse(localStorage.getItem("pending_sync")||"[]"),t=e.length>0;return{online:navigator.onLine,hasPendingSync:t,pendingCount:e.length,lastSync:localStorage.getItem("last_sync_timestamp"),supportsBgSync:"sync"in window.ServiceWorkerRegistration.prototype}}}class k{constructor(){this.refreshIntervals=new Map,this.refreshCallbacks=new Map,this.isActive=!0,this.networkStatus=navigator.onLine,this.config={intervals:{ticketPrices:30*1e3,ticketAlerts:45*1e3,watchlist:60*1e3,dashboard:120*1e3,analytics:300*1e3,notifications:15*1e3},retryDelays:[1e3,2e3,5e3,1e4],maxConsecutiveFailures:3},this.retryCounters=new Map,this.lastUpdateTimes=new Map,this.init()}init(){this.bindEventListeners(),this.startCriticalRefreshers(),console.log("Auto Refresh Manager initialized")}bindEventListeners(){window.addEventListener("online",()=>{this.networkStatus=!0,this.resumeAllRefreshers(),console.log("Network restored - resuming auto refresh")}),window.addEventListener("offline",()=>{this.networkStatus=!1,this.pauseAllRefreshers(),console.log("Network lost - pausing auto refresh")}),document.addEventListener("visibilitychange",()=>{document.hidden?this.pauseNonCriticalRefreshers():(this.resumeAllRefreshers(),this.performImmediateRefresh())}),["mousedown","mousemove","keypress","scroll","touchstart"].forEach(t=>{document.addEventListener(t,()=>this.onUserActivity(),{passive:!0})}),document.addEventListener("refresh:request",t=>{this.refreshData(t.detail.type,t.detail.force)})}startCriticalRefreshers(){this.startRefresher("notifications"),this.startContextualRefreshers()}startContextualRefreshers(){const e=window.location.pathname;e.includes("/dashboard")&&(this.startRefresher("dashboard"),this.startRefresher("ticketAlerts")),(e.includes("/tickets")||e.includes("/search"))&&this.startRefresher("ticketPrices"),e.includes("/watchlist")&&(this.startRefresher("watchlist"),this.startRefresher("ticketPrices")),e.includes("/analytics")&&this.startRefresher("analytics"),(e.includes("/alerts")||e.includes("/monitoring"))&&this.startRefresher("ticketAlerts")}startRefresher(e){if(this.refreshIntervals.has(e))return;const t=this.config.intervals[e];if(!t){console.warn(`No refresh interval configured for: ${e}`);return}const s=setInterval(()=>{this.shouldRefresh(e)&&this.refreshData(e)},t);this.refreshIntervals.set(e,s),console.log(`Started auto refresh for ${e} (${t}ms)`),setTimeout(()=>this.refreshData(e),1e3)}stopRefresher(e){const t=this.refreshIntervals.get(e);t&&(clearInterval(t),this.refreshIntervals.delete(e),console.log(`Stopped auto refresh for ${e}`))}shouldRefresh(e){return!this.networkStatus||!this.isActive?!1:(this.retryCounters.get(e)||0)>=this.config.maxConsecutiveFailures?(console.warn(`Too many failures for ${e}, skipping refresh`),!1):!(document.hidden&&!this.isCriticalRefresher(e))}isCriticalRefresher(e){return["notifications","ticketAlerts"].includes(e)}async refreshData(e,t=!1){if(!(!t&&!this.shouldRefresh(e)))try{const s=this.getEndpoint(e),i=this.lastUpdateTimes.get(e)||0,a={"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json"};i&&!t&&(a["If-Modified-Since"]=new Date(i).toUTCString());const o=await fetch(s,{headers:a,credentials:"same-origin"});if(o.status===304){console.log(`${e} data not modified`);return}if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);const u=await o.json();await this.processRefreshData(e,u),this.retryCounters.set(e,0),this.lastUpdateTimes.set(e,Date.now()),console.log(`Successfully refreshed ${e} data`),document.dispatchEvent(new CustomEvent("data:refreshed",{detail:{type:e,data:u,timestamp:Date.now()}}))}catch(s){console.error(`Failed to refresh ${e} data:`,s);const i=(this.retryCounters.get(e)||0)+1;if(this.retryCounters.set(e,i),i<this.config.maxConsecutiveFailures){const a=this.config.retryDelays[Math.min(i-1,this.config.retryDelays.length-1)];setTimeout(()=>this.refreshData(e),a)}document.dispatchEvent(new CustomEvent("data:refresh-failed",{detail:{type:e,error:s.message,failures:i}}))}}getEndpoint(e){return{ticketPrices:"/api/refresh/ticket-prices",ticketAlerts:"/api/refresh/ticket-alerts",watchlist:"/api/refresh/watchlist",dashboard:"/api/refresh/dashboard",analytics:"/api/refresh/analytics",notifications:"/api/refresh/notifications"}[e]}async processRefreshData(e,t){switch(e){case"ticketPrices":await this.updateTicketPrices(t);break;case"ticketAlerts":await this.updateTicketAlerts(t);break;case"watchlist":await this.updateWatchlist(t);break;case"dashboard":await this.updateDashboard(t);break;case"analytics":await this.updateAnalytics(t);break;case"notifications":await this.updateNotifications(t);break;default:console.warn(`No processor for refresh type: ${e}`)}}async updateTicketPrices(e){e.prices&&e.prices.forEach(t=>{document.querySelectorAll(`[data-ticket-id="${t.ticket_id}"] .price`).forEach(i=>{const a=parseFloat(i.dataset.price||"0"),o=parseFloat(t.current_price);i.textContent=`$${o.toFixed(2)}`,i.dataset.price=o,a!==o&&(i.classList.remove("price-up","price-down"),o>a?i.classList.add("price-up"):o<a&&i.classList.add("price-down"),i.style.animation="none",i.offsetHeight,i.style.animation="priceChange 0.5s ease-out")})})}async updateTicketAlerts(e){if(e.alerts){const t=document.querySelector(".alert-count");t&&(t.textContent=e.total_active||0);const s=e.alerts.filter(i=>i.triggered);s.length>0&&document.dispatchEvent(new CustomEvent("alerts:triggered",{detail:{alerts:s}}))}}async updateWatchlist(e){e.watchlist_items&&document.querySelector(".watchlist-container")&&document.dispatchEvent(new CustomEvent("watchlist:updated",{detail:{items:e.watchlist_items}}))}async updateDashboard(e){e.stats&&Object.entries(e.stats).forEach(([t,s])=>{const i=document.querySelector(`[data-stat="${t}"]`);i&&(i.textContent=s)})}async updateAnalytics(e){e.analytics&&window.updateAnalyticsCharts&&window.updateAnalyticsCharts(e.analytics)}async updateNotifications(e){if(e.notifications!==void 0){const t=e.unread_count||0;document.querySelectorAll(".notification-badge").forEach(i=>{i.style.display=t>0?"inline-flex":"none",i.textContent=t}),document.dispatchEvent(new CustomEvent("notifications:updated",{detail:{notifications:e.notifications,unreadCount:t}}))}}onUserActivity(){this.retryCounters.clear(),this.isActive||(this.isActive=!0,this.resumeAllRefreshers())}pauseAllRefreshers(){this.isActive=!1,console.log("Paused all auto refreshers")}pauseNonCriticalRefreshers(){["ticketPrices","watchlist","dashboard","analytics"].forEach(t=>{const s=this.refreshIntervals.get(t);s&&(clearInterval(s),this.refreshIntervals.delete(t))}),console.log("Paused non-critical auto refreshers")}resumeAllRefreshers(){this.networkStatus&&(this.isActive=!0,this.startContextualRefreshers(),console.log("Resumed all auto refreshers"))}performImmediateRefresh(){Array.from(this.refreshIntervals.keys()).forEach(t=>{setTimeout(()=>this.refreshData(t,!0),Math.random()*2e3)})}forceRefresh(e=null){e?this.refreshData(e,!0):this.performImmediateRefresh()}getRefreshStatus(){return{isActive:this.isActive,networkStatus:this.networkStatus,activeRefreshers:Array.from(this.refreshIntervals.keys()),retryCounters:Object.fromEntries(this.retryCounters),lastUpdateTimes:Object.fromEntries(this.lastUpdateTimes)}}destroy(){this.refreshIntervals.forEach(e=>clearInterval(e)),this.refreshIntervals.clear(),this.refreshCallbacks.clear(),this.isActive=!1,console.log("Auto Refresh Manager destroyed")}}class b{constructor(){this.deferredPrompt=null,this.isInstalled=!1,this.installPromptShown=!1,this.config={minVisits:3,minTimeOnSite:6e4,minInteractions:5,cooldownPeriod:10080*60*1e3,purchaseThreshold:1,alertThreshold:2,watchlistThreshold:3},this.userStats=this.loadUserStats(),this.sessionStart=Date.now(),this.interactionCount=0,this.init()}init(){this.detectInstallState(),this.bindEventListeners(),this.trackUserEngagement(),console.log("Install Prompt Manager initialized")}detectInstallState(){window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches&&(this.isInstalled=!0,console.log("PWA is running in standalone mode")),window.navigator.standalone===!0&&(this.isInstalled=!0,console.log("PWA is running in iOS standalone mode")),document.referrer.startsWith("android-app://")&&(this.isInstalled=!0,console.log("PWA is running via Android app intent")),localStorage.getItem("hd_tickets_installed")==="true"&&(this.isInstalled=!0)}bindEventListeners(){window.addEventListener("beforeinstallprompt",t=>{console.log("Install prompt available"),t.preventDefault(),this.deferredPrompt=t,this.evaluateInstallPrompt()}),window.addEventListener("appinstalled",()=>{console.log("PWA installed successfully"),this.isInstalled=!0,localStorage.setItem("hd_tickets_installed","true"),this.deferredPrompt=null,this.onInstallComplete()}),["click","touchstart","keydown","scroll"].forEach(t=>{document.addEventListener(t,()=>this.trackInteraction(),{passive:!0})}),document.addEventListener("visibilitychange",()=>{document.hidden||this.trackVisit()}),document.addEventListener("ticket:purchased",()=>this.trackHighValueAction("purchase")),document.addEventListener("alert:created",()=>this.trackHighValueAction("alert")),document.addEventListener("watchlist:added",()=>this.trackHighValueAction("watchlist")),document.addEventListener("install:request",()=>this.showInstallPrompt()),document.addEventListener("install:dismiss",()=>this.dismissInstallPrompt())}trackUserEngagement(){this.userStats.visits++,this.userStats.lastVisit=Date.now(),this.saveUserStats(),setInterval(()=>{this.userStats.totalTimeOnSite+=3e4,this.saveUserStats()},3e4)}trackInteraction(){this.interactionCount++,this.userStats.totalInteractions++,this.saveUserStats()}trackVisit(){this.userStats.visits++,this.saveUserStats()}trackHighValueAction(e){this.userStats.highValueActions[e]||(this.userStats.highValueActions[e]=0),this.userStats.highValueActions[e]++,this.userStats.lastHighValueAction=Date.now(),this.saveUserStats(),setTimeout(()=>this.evaluateInstallPrompt(),2e3)}async evaluateInstallPrompt(){if(this.isInstalled||this.installPromptShown||!this.deferredPrompt)return!1;const e=this.calculateInstallCriteria();return console.log("Install criteria evaluation:",e),e.shouldShow?(await this.showSmartInstallPrompt(e.reason),!0):!1}calculateInstallCriteria(){const e=this.userStats,t=Date.now()-this.sessionStart;if(e.lastPromptDismissed&&Date.now()-e.lastPromptDismissed<this.config.cooldownPeriod)return{shouldShow:!1,reason:"cooldown"};if(e.highValueActions.purchase>=this.config.purchaseThreshold)return{shouldShow:!0,reason:"purchase_activity"};if(e.highValueActions.alert>=this.config.alertThreshold)return{shouldShow:!0,reason:"alert_engagement"};if(e.highValueActions.watchlist>=this.config.watchlistThreshold)return{shouldShow:!0,reason:"watchlist_usage"};const s=(e.visits>=this.config.minVisits?1:0)+(e.totalTimeOnSite>=this.config.minTimeOnSite?1:0)+(this.interactionCount>=this.config.minInteractions?1:0)+(t>=this.config.minTimeOnSite?1:0);return s>=3?{shouldShow:!0,reason:"engagement_threshold"}:{shouldShow:!1,reason:"insufficient_engagement",score:s}}async showSmartInstallPrompt(e="engagement"){if(!this.deferredPrompt)return!1;this.installPromptShown=!0;try{const t=this.createInstallPromptUI(e);return document.body.appendChild(t),this.userStats.promptsShown++,this.userStats.lastPromptShown=Date.now(),this.saveUserStats(),!0}catch(t){return console.error("Failed to show install prompt:",t),!1}}createInstallPromptUI(e){const t=document.createElement("div");t.className="fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/50 backdrop-blur-sm",t.setAttribute("data-install-prompt","true");const s={purchase_activity:"You're actively using HD Tickets for purchases! Install the app for faster checkout and real-time alerts.",alert_engagement:"Stay on top of price drops! Install HD Tickets for instant notifications even when your browser is closed.",watchlist_usage:"Your watchlist is growing! Get the HD Tickets app for quick access and background monitoring.",engagement_threshold:"You're getting great value from HD Tickets! Install the app for the best experience.",default:"Get instant access to sports ticket deals! Install HD Tickets for real-time alerts and faster browsing."},i=s[e]||s.default;return t.innerHTML=`
      <div class="bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md mx-4 p-6 transform transition-all duration-300 translate-y-full sm:translate-y-0 sm:scale-95" data-prompt-content>
        <div class="flex items-start space-x-4">
          <div class="flex-shrink-0">
            <img src="/images/icons/icon-96x96.png" alt="HD Tickets" class="w-16 h-16 rounded-2xl shadow-lg">
          </div>
          <div class="flex-1 min-w-0">
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Install HD Tickets</h3>
            <p class="text-sm text-gray-600 mb-4">${i}</p>
            
            <div class="flex flex-col space-y-2">
              <button data-install-action="install" class="w-full bg-indigo-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-indigo-700 transition-colors">
                <span class="flex items-center justify-center">
                  <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                  </svg>
                  Add to Home Screen
                </span>
              </button>
              <button data-install-action="dismiss" class="w-full text-gray-500 px-4 py-2 rounded-lg font-medium hover:text-gray-700 transition-colors">
                Not now
              </button>
            </div>
          </div>
          
          <button data-install-action="close" class="flex-shrink-0 p-1 text-gray-400 hover:text-gray-600">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        
        <div class="mt-4 flex items-center space-x-4 text-xs text-gray-500">
          <div class="flex items-center">
            <svg class="w-4 h-4 mr-1 text-green-500" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
            <span>Works offline</span>
          </div>
          <div class="flex items-center">
            <svg class="w-4 h-4 mr-1 text-green-500" fill="currentColor" viewBox="0 0 20 20">
              <path d="M15 8a3 3 0 10-2.977-2.63l-4.94 2.47a3 3 0 100 4.319l4.94 2.47a3 3 0 10.895-1.789l-4.94-2.47a3.027 3.027 0 000-.74l4.94-2.47C13.456 7.68 14.19 8 15 8z"></path>
            </svg>
            <span>Push notifications</span>
          </div>
        </div>
      </div>
    `,requestAnimationFrame(()=>{const a=t.querySelector("[data-prompt-content]");a.classList.remove("translate-y-full","sm:scale-95"),a.classList.add("translate-y-0","sm:scale-100")}),this.bindInstallPromptActions(t),t}bindInstallPromptActions(e){e.addEventListener("click",t=>{switch(t.target.closest("[data-install-action]")?.dataset.installAction){case"install":this.executeInstall();break;case"dismiss":this.dismissInstallPrompt(!1);break;case"close":this.dismissInstallPrompt(!0);break}t.target===e&&this.dismissInstallPrompt(!0)})}async executeInstall(){if(this.deferredPrompt)try{const e=await this.deferredPrompt.prompt();console.log("Install prompt result:",e),this.userStats.installAttempts++,e.outcome==="accepted"?(this.userStats.installAccepted=!0,this.userStats.installDate=Date.now(),console.log("User accepted the install prompt")):console.log("User dismissed the install prompt"),this.deferredPrompt=null,this.saveUserStats(),this.removeInstallPromptUI()}catch(e){console.error("Install prompt error:",e),this.removeInstallPromptUI()}}dismissInstallPrompt(e=!1){this.userStats.promptsDismissed++,this.userStats.lastPromptDismissed=Date.now(),e&&(this.userStats.installPermanentlyDismissed=!0),this.saveUserStats(),this.removeInstallPromptUI()}removeInstallPromptUI(){const e=document.querySelector("[data-install-prompt]");if(e){const t=e.querySelector("[data-prompt-content]");t?(t.classList.add("translate-y-full","sm:scale-95"),setTimeout(()=>e.remove(),300)):e.remove()}this.installPromptShown=!1}showInstallPrompt(){this.deferredPrompt&&!this.isInstalled&&!this.installPromptShown&&this.showSmartInstallPrompt("manual")}onInstallComplete(){this.showInstallThankYou(),window.gtag&&gtag("event","app_install",{method:"pwa",content_type:"sports_tickets"}),setTimeout(()=>{document.dispatchEvent(new CustomEvent("install:complete"))},2e3)}showInstallThankYou(){const e=document.createElement("div");e.className="fixed top-4 right-4 z-50 bg-green-500 text-white p-4 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300",e.innerHTML=`
      <div class="flex items-center space-x-3">
        <svg class="w-6 h-6 text-green-100" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
        </svg>
        <div>
          <p class="font-medium">HD Tickets installed!</p>
          <p class="text-sm text-green-100">Access from your home screen</p>
        </div>
      </div>
    `,document.body.appendChild(e),requestAnimationFrame(()=>{e.classList.remove("translate-x-full")}),setTimeout(()=>{e.classList.add("translate-x-full"),setTimeout(()=>e.remove(),300)},5e3)}loadUserStats(){const e={visits:0,totalTimeOnSite:0,totalInteractions:0,highValueActions:{purchase:0,alert:0,watchlist:0},promptsShown:0,promptsDismissed:0,installAttempts:0,installAccepted:!1,installPermanentlyDismissed:!1,firstVisit:Date.now(),lastVisit:null,lastPromptShown:null,lastPromptDismissed:null,lastHighValueAction:null,installDate:null};try{const t=localStorage.getItem("hd_tickets_install_stats");return t?{...e,...JSON.parse(t)}:e}catch(t){return console.error("Failed to load install stats:",t),e}}saveUserStats(){try{localStorage.setItem("hd_tickets_install_stats",JSON.stringify(this.userStats))}catch(e){console.error("Failed to save install stats:",e)}}canShowInstallPrompt(){return!this.isInstalled&&!!this.deferredPrompt&&!this.installPromptShown&&!this.userStats.installPermanentlyDismissed}getInstallStats(){return{isInstalled:this.isInstalled,canInstall:this.canShowInstallPrompt(),userStats:this.userStats,sessionInteractions:this.interactionCount,sessionTime:Date.now()-this.sessionStart}}forceShowPrompt(){this.canShowInstallPrompt()&&this.showSmartInstallPrompt("manual")}resetInstallStats(){localStorage.removeItem("hd_tickets_install_stats"),localStorage.removeItem("hd_tickets_installed"),this.userStats=this.loadUserStats(),console.log("Install stats reset")}destroy(){this.deferredPrompt=null,this.removeInstallPromptUI(),console.log("Install Prompt Manager destroyed")}}class A{constructor(){this.appVersion="1.0.0",this.isOnline=navigator.onLine,this.isVisible=!document.hidden,this.serviceWorker=null,this.updateAvailable=!1,this.refreshing=!1,this.config={updateCheckInterval:1800*1e3,offlineThreshold:5e3,retryDelay:2e3,maxRetries:3},this.lifecycleState="loading",this.beforeUnloadListeners=new Set,this.init()}init(){this.bindEventListeners(),this.initServiceWorker(),this.startUpdateChecker(),this.detectLifecycleState(),console.log("App Lifecycle Manager initialized")}bindEventListeners(){window.addEventListener("online",()=>this.handleOnline()),window.addEventListener("offline",()=>this.handleOffline()),document.addEventListener("visibilitychange",()=>this.handleVisibilityChange()),document.addEventListener("freeze",()=>this.handleFreeze()),document.addEventListener("resume",()=>this.handleResume()),window.addEventListener("beforeunload",e=>this.handleBeforeUnload(e)),window.addEventListener("unload",()=>this.handleUnload()),window.addEventListener("focus",()=>this.handleFocus()),window.addEventListener("blur",()=>this.handleBlur()),document.addEventListener("install:complete",()=>this.handleAppInstalled()),document.addEventListener("update:available",()=>this.handleUpdateAvailable()),document.addEventListener("update:apply",()=>this.applyUpdate())}async initServiceWorker(){if(!("serviceWorker"in navigator)){console.warn("Service workers not supported");return}try{const e=await navigator.serviceWorker.ready;this.serviceWorker=e,e.addEventListener("updatefound",()=>{const t=e.installing;t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&(console.log("New service worker installed, update available"),this.updateAvailable=!0,this.showUpdatePrompt())})}),navigator.serviceWorker.addEventListener("message",t=>{this.handleServiceWorkerMessage(t.data)}),console.log("Service worker initialized")}catch(e){console.error("Failed to initialize service worker:",e)}}handleServiceWorkerMessage(e){switch(e.type){case"UPDATE_AVAILABLE":this.updateAvailable=!0,this.showUpdatePrompt();break;case"CACHE_UPDATED":console.log("App cache updated");break;case"SYNC_COMPLETE":document.dispatchEvent(new CustomEvent("lifecycle:sync-complete",{detail:e.data}));break;default:console.log("Service worker message:",e)}}startUpdateChecker(){setInterval(()=>{this.isOnline&&!document.hidden&&this.checkForUpdates()},this.config.updateCheckInterval),document.addEventListener("visibilitychange",()=>{!document.hidden&&this.isOnline&&setTimeout(()=>this.checkForUpdates(),1e3)})}async checkForUpdates(){if(this.serviceWorker)try{await this.serviceWorker.update(),console.log("Checked for service worker updates")}catch(e){console.error("Failed to check for updates:",e)}}detectLifecycleState(){document.hidden?this.lifecycleState="hidden":this.lifecycleState="active",this.notifyLifecycleChange(this.lifecycleState)}handleOnline(){this.isOnline=!0,console.log("App went online"),document.dispatchEvent(new CustomEvent("lifecycle:online",{detail:{timestamp:Date.now()}})),this.triggerOnlineRecovery()}handleOffline(){this.isOnline=!1,console.log("App went offline"),document.dispatchEvent(new CustomEvent("lifecycle:offline",{detail:{timestamp:Date.now()}}))}handleVisibilityChange(){const e=this.isVisible;this.isVisible=!document.hidden,this.isVisible&&!e?(this.lifecycleState="active",console.log("App became visible/active"),document.dispatchEvent(new CustomEvent("lifecycle:visible",{detail:{timestamp:Date.now()}})),this.handleAppResume()):!this.isVisible&&e&&(this.lifecycleState="hidden",console.log("App became hidden"),document.dispatchEvent(new CustomEvent("lifecycle:hidden",{detail:{timestamp:Date.now()}})),this.handleAppPause()),this.notifyLifecycleChange(this.lifecycleState)}handleFreeze(){this.lifecycleState="frozen",console.log("App frozen by browser"),document.dispatchEvent(new CustomEvent("lifecycle:frozen",{detail:{timestamp:Date.now()}})),this.saveAppState()}handleResume(){this.lifecycleState="active",console.log("App resumed from frozen state"),document.dispatchEvent(new CustomEvent("lifecycle:resumed",{detail:{timestamp:Date.now()}})),this.restoreAppState()}handleFocus(){this.isVisible&&(this.lifecycleState="active",this.handleAppResume())}handleBlur(){this.isVisible&&this.handleAppPause()}handleBeforeUnload(e){if(console.log("App about to unload"),this.beforeUnloadListeners.forEach(t=>{try{t(e)}catch(s){console.error("Before unload callback error:",s)}}),this.saveAppState(),this.shouldShowUnloadConfirmation()){const t="You have unsaved changes. Are you sure you want to leave?";return e.returnValue=t,t}}handleUnload(){this.lifecycleState="terminated",console.log("App unloaded"),document.dispatchEvent(new CustomEvent("lifecycle:terminated",{detail:{timestamp:Date.now()}}))}handleAppInstalled(){console.log("App installed successfully"),this.enableInstallFeatures(),document.dispatchEvent(new CustomEvent("lifecycle:installed",{detail:{timestamp:Date.now()}}))}handleAppResume(){console.log("App resumed/activated"),this.isOnline&&setTimeout(()=>this.checkForUpdates(),500),document.dispatchEvent(new CustomEvent("lifecycle:resume",{detail:{timestamp:Date.now(),shouldRefresh:this.isOnline}}))}handleAppPause(){console.log("App paused/deactivated"),this.saveAppState(),document.dispatchEvent(new CustomEvent("lifecycle:pause",{detail:{timestamp:Date.now()}}))}triggerOnlineRecovery(){document.dispatchEvent(new CustomEvent("lifecycle:online-recovery",{detail:{timestamp:Date.now()}})),setTimeout(()=>{document.dispatchEvent(new CustomEvent("sync:request",{detail:{tag:"online-recovery",force:!0}}))},1e3)}saveAppState(){try{const e={version:this.appVersion,timestamp:Date.now(),url:window.location.href,scrollPosition:{x:window.scrollX,y:window.scrollY},lifecycleState:this.lifecycleState,isOnline:this.isOnline};localStorage.setItem("hd_tickets_app_state",JSON.stringify(e)),console.log("App state saved")}catch(e){console.error("Failed to save app state:",e)}}restoreAppState(){try{const e=localStorage.getItem("hd_tickets_app_state");if(!e)return;const t=JSON.parse(e);t.url===window.location.href&&t.scrollPosition&&window.scrollTo(t.scrollPosition.x,t.scrollPosition.y),console.log("App state restored"),document.dispatchEvent(new CustomEvent("lifecycle:state-restored",{detail:t}))}catch(e){console.error("Failed to restore app state:",e)}}shouldShowUnloadConfirmation(){const e=localStorage.getItem("hd_tickets_unsaved_data")==="true",t=localStorage.getItem("hd_tickets_active_purchases")==="true";return e||t}enableInstallFeatures(){document.body.classList.add("app-installed"),this.serviceWorker&&this.serviceWorker.postMessage({type:"ENABLE_INSTALL_FEATURES"}),document.querySelectorAll(".show-when-installed").forEach(e=>{e.style.display="block"})}showUpdatePrompt(){if(this.refreshing)return;const e=this.createUpdatePromptUI();document.body.appendChild(e),setTimeout(()=>{document.contains(e)&&e.remove()},3e4)}createUpdatePromptUI(){const e=document.createElement("div");return e.className="fixed top-4 right-4 z-50 bg-blue-500 text-white p-4 rounded-lg shadow-lg max-w-sm transform translate-x-full transition-transform duration-300",e.setAttribute("data-update-prompt","true"),e.innerHTML=`
      <div class="flex items-start space-x-3">
        <svg class="w-6 h-6 text-blue-200 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd"></path>
        </svg>
        <div class="flex-1">
          <p class="font-medium text-sm">Update Available</p>
          <p class="text-xs text-blue-100 mt-1">A new version of HD Tickets is ready. Restart to apply updates.</p>
          <div class="flex space-x-2 mt-3">
            <button data-update-action="apply" class="px-3 py-1 bg-white text-blue-500 text-xs font-medium rounded hover:bg-blue-50 transition-colors">
              Update Now
            </button>
            <button data-update-action="dismiss" class="px-3 py-1 text-blue-100 text-xs font-medium rounded hover:text-white transition-colors">
              Later
            </button>
          </div>
        </div>
        <button data-update-action="close" class="text-blue-200 hover:text-white">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
    `,requestAnimationFrame(()=>{e.classList.remove("translate-x-full")}),e.addEventListener("click",t=>{switch(t.target.closest("[data-update-action]")?.dataset.updateAction){case"apply":this.applyUpdate();break;case"dismiss":case"close":e.classList.add("translate-x-full"),setTimeout(()=>e.remove(),300);break}}),e}async applyUpdate(){if(!(!this.serviceWorker||this.refreshing)){this.refreshing=!0;try{console.log("Applying app update..."),this.showUpdateProgress();const e=await navigator.serviceWorker.getRegistration();e&&e.waiting&&e.waiting.postMessage({type:"SKIP_WAITING"}),setTimeout(()=>{window.location.reload()},1e3)}catch(e){console.error("Failed to apply update:",e),this.refreshing=!1}}}showUpdateProgress(){const e=document.createElement("div");e.className="fixed inset-0 z-50 flex items-center justify-center bg-black/50",e.innerHTML=`
      <div class="bg-white rounded-lg p-6 max-w-sm mx-4 text-center">
        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto mb-4"></div>
        <p class="font-medium text-gray-900">Updating HD Tickets...</p>
        <p class="text-sm text-gray-500 mt-1">This will only take a moment</p>
      </div>
    `,document.body.appendChild(e)}handleUpdateAvailable(){this.updateAvailable=!0,this.showUpdatePrompt()}notifyLifecycleChange(e){document.dispatchEvent(new CustomEvent("lifecycle:state-change",{detail:{state:e,timestamp:Date.now(),isOnline:this.isOnline,isVisible:this.isVisible}}))}addBeforeUnloadListener(e){this.beforeUnloadListeners.add(e)}removeBeforeUnloadListener(e){this.beforeUnloadListeners.delete(e)}getAppState(){return{version:this.appVersion,lifecycleState:this.lifecycleState,isOnline:this.isOnline,isVisible:this.isVisible,updateAvailable:this.updateAvailable,serviceWorkerReady:!!this.serviceWorker}}markUnsavedChanges(e=!0){localStorage.setItem("hd_tickets_unsaved_data",e.toString())}markActivePurchases(e=!0){localStorage.setItem("hd_tickets_active_purchases",e.toString())}forceUpdate(){this.applyUpdate()}destroy(){this.beforeUnloadListeners.clear(),this.refreshing=!1,console.log("App Lifecycle Manager destroyed")}}var h={};window.Pusher=g;const C={broadcaster:"pusher",key:h.MIX_PUSHER_APP_KEY||window.pusherKey,cluster:h.MIX_PUSHER_APP_CLUSTER||window.pusherCluster||"mt1",forceTLS:!0,encrypted:!0,auth:{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",Accept:"application/json"}},pusherOptions:{cluster:h.MIX_PUSHER_APP_CLUSTER||window.pusherCluster||"mt1",forceTLS:!0,encrypted:!0,enabledTransports:["ws","wss"],disabledTransports:["xhr_polling","xhr_streaming"],activityTimeout:12e4,pongTimeout:3e4,unavailableTimeout:16e3,enableStats:!1,enableLogging:!1,authorizer:(n,e)=>({authorize:(t,s)=>{axios.post("/broadcasting/auth",{socket_id:t,channel_name:n.name},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}}).then(i=>{s(null,i.data)}).catch(i=>{s(i,null)})}})}},r=new v(C);window.Echo=r;if(r.connector&&r.connector.pusher){const n=r.connector.pusher;n.connection.bind("connected",()=>{console.log("âœ… WebSocket connected successfully"),document.dispatchEvent(new CustomEvent("echo:connected",{detail:{socketId:n.connection.socket_id}})),c("connected")}),n.connection.bind("disconnected",()=>{console.log("âŒ WebSocket disconnected"),document.dispatchEvent(new CustomEvent("echo:disconnected")),c("disconnected")}),n.connection.bind("error",e=>{console.error("ðŸ”´ WebSocket connection error:",e),document.dispatchEvent(new CustomEvent("echo:error",{detail:{error:e}})),c("error"),window.hdTicketsApp&&window.hdTicketsApp.trackError(new Error(`WebSocket error: ${e}`))}),n.connection.bind("unavailable",()=>{console.warn("âš ï¸ WebSocket unavailable - will retry"),document.dispatchEvent(new CustomEvent("echo:unavailable")),c("unavailable")}),n.connection.bind("connecting",()=>{console.log("ðŸ”„ WebSocket reconnecting..."),c("connecting")}),n.connection.bind("state_change",e=>{console.log(`ðŸ”„ WebSocket state: ${e.previous} â†’ ${e.current}`),document.dispatchEvent(new CustomEvent("echo:state_change",{detail:e}))})}function c(n){document.querySelectorAll("[data-connection-status]").forEach(t=>{t.setAttribute("data-connection-status",n);const s=t.querySelector("[data-status-text]");if(s){const a={connected:"Connected",disconnected:"Disconnected",connecting:"Connecting...",error:"Connection Error",unavailable:"Service Unavailable"};s.textContent=a[n]||n}const i=t.querySelector("[data-status-icon]");i&&(i.className=I(n))})}function I(n){return{connected:"w-3 h-3 bg-green-500 rounded-full",disconnected:"w-3 h-3 bg-red-500 rounded-full",connecting:"w-3 h-3 bg-yellow-500 rounded-full animate-pulse",error:"w-3 h-3 bg-red-600 rounded-full animate-bounce",unavailable:"w-3 h-3 bg-gray-500 rounded-full"}[n]||"w-3 h-3 bg-gray-400 rounded-full"}window.EchoHelpers={subscribeToTicket(n,e={}){const t=r.channel(`ticket.${n}`);return e.onPriceChange&&t.listen("TicketPriceChanged",e.onPriceChange),e.onAvailabilityChange&&t.listen("TicketAvailabilityChanged",e.onAvailabilityChange),e.onStatusChange&&t.listen("TicketStatusChanged",e.onStatusChange),e.onUpdate&&t.listen("TicketUpdated",e.onUpdate),t},subscribeToUserNotifications(n,e={}){const t=r.private(`user.${n}`);return e.onPriceAlert&&t.listen("PriceAlertTriggered",e.onPriceAlert),e.onBookmarkUpdate&&t.listen("BookmarkUpdated",e.onBookmarkUpdate),e.onNotification&&t.listen("UserNotification",e.onNotification),t},subscribeToSystemAnnouncements(n={}){const e=r.channel("system.announcements");return n.onMaintenance&&e.listen("MaintenanceScheduled",n.onMaintenance),n.onServiceUpdate&&e.listen("ServiceUpdated",n.onServiceUpdate),n.onAnnouncement&&e.listen("SystemAnnouncement",n.onAnnouncement),e},subscribeToSearchUpdates(n,e={}){const t=r.channel(`search.${n}`);return e.onNewResults&&t.listen("SearchResultsUpdated",e.onNewResults),e.onSearchComplete&&t.listen("SearchCompleted",e.onSearchComplete),t},leaveChannel(n){r.leaveChannel(n)},getSocketId(){return r.connector?.pusher?.connection?.socket_id||null},isConnected(){return r.connector?.pusher?.connection?.state==="connected"},disconnect(){r.connector?.pusher&&r.connector.pusher.disconnect()},reconnect(){r.connector?.pusher&&r.connector.pusher.connect()}};let l=0;const m=5,L=1e3;function P(){if(l>=m){console.error("âŒ Max reconnection attempts reached"),document.dispatchEvent(new CustomEvent("echo:max_reconnect_attempts"));return}const n=L*Math.pow(2,l);l++,console.log(`ðŸ”„ Attempting reconnection ${l}/${m} in ${n}ms`),setTimeout(()=>{window.EchoHelpers.isConnected()||window.EchoHelpers.reconnect()},n)}document.addEventListener("echo:connected",()=>{l=0});document.addEventListener("echo:disconnected",()=>{document.hidden||setTimeout(P,1e3)});document.addEventListener("visibilitychange",()=>{document.hidden?console.log("ðŸ“± Page hidden - maintaining connection"):(console.log("ðŸ‘€ Page visible - checking connection"),window.EchoHelpers.isConnected()||window.EchoHelpers.reconnect())});window.addEventListener("beforeunload",()=>{r.connector?.pusher&&r.connector.pusher.disconnect()});window.addEventListener("DOMContentLoaded",()=>{try{const n=new S({contentSelector:"main",transition:"fade"});window.__appShellNav=n;const e=new E;window.__syncManager=e;const t=new k;window.__refreshManager=t;const s=new b;window.__installManager=s;const i=new A;window.__lifecycleManager=i,T(e,t,s,i),console.log("HD Tickets PWA initialized successfully")}catch(n){console.error("Failed to initialize HD Tickets PWA:",n)}});function T(n,e,t,s){document.addEventListener("data:changed",a=>{n.scheduleSync(a.detail.type,a.detail.data)}),document.addEventListener("refresh:request",a=>{e.forceRefresh(a.detail.type)}),document.addEventListener("sync:success",a=>{window.showNotification&&window.showNotification("Data synced successfully","success")}),document.addEventListener("offline:retry-sync",()=>{navigator.onLine&&(n.forceSyncAll(),e.forceRefresh())}),document.addEventListener("visibilitychange",()=>{!document.hidden&&navigator.onLine&&e.forceRefresh()}),document.addEventListener("beforeinstallprompt",a=>{document.dispatchEvent(new CustomEvent("install:prompt-available",{detail:a}))}),document.addEventListener("appinstalled",()=>{window.showNotification&&window.showNotification("HD Tickets installed successfully!","success")}),document.addEventListener("lifecycle:state-change",a=>{console.log("App lifecycle state changed:",a.detail.state),a.detail.state==="hidden"||a.detail.state==="frozen"?e.pauseNonCriticalRefreshers():a.detail.state==="active"&&(e.resumeAllRefreshers(),a.detail.isOnline&&n.forceSyncAll())});const i=a=>{document.dispatchEvent(new CustomEvent(`${a}:completed`,{detail:{timestamp:Date.now()}}))};document.addEventListener("submit",a=>{a.target.closest('[data-track="purchase"]')?i("ticket:purchased"):a.target.closest('[data-track="alert"]')?i("alert:created"):a.target.closest('[data-track="watchlist"]')&&i("watchlist:added")}),document.addEventListener("data:changed",a=>{a.detail.hasUnsavedChanges?s.markUnsavedChanges(!0):s.markUnsavedChanges(!1)}),document.addEventListener("purchase:started",()=>{s.markActivePurchases(!0)}),document.addEventListener("purchase:completed",()=>{s.markActivePurchases(!1)}),window.addEventListener("error",a=>{console.error("Global error:",a.error)}),window.addEventListener("unhandledrejection",a=>{console.error("Unhandled promise rejection:",a.reason)})}window.Alpine=f;document.querySelector("[data-ticket-system]")&&w(()=>import("./index.CYHJt075.js").then(n=>n.i),[]);f.start();"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(n=>{console.info("SW registered: ",n)}).catch(n=>{console.error("SW registration failed: ",n)})});let d;window.addEventListener("beforeinstallprompt",n=>{n.preventDefault(),d=n;const e=document.getElementById("install-app-btn");e&&(e.style.display="block",e.addEventListener("click",()=>{e.style.display="none",d.prompt(),d.userChoice.then(t=>{t.outcome==="accepted"?console.info("User accepted the install prompt"):console.warn("User dismissed the install prompt"),d=null})}))});window.addEventListener("error",n=>{console.error("Global error:",n.error)});window.addEventListener("unhandledrejection",n=>{console.error("Unhandled promise rejection:",n.reason)});
