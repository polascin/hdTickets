<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alpine.js Debug Test</title>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script>
        document.addEventListener('alpine:init', () => {
            console.log('üöÄ Alpine.js is initializing...');
            
            // Register a simple navigationData component for testing
            Alpine.data('navigationData', () => ({
                adminDropdownOpen: false,
                profileDropdownOpen: false,
                mobileMenuOpen: false,
                
                init() {
                    console.log('üìç NavigationData component initialized');
                    
                    // Close dropdowns when clicking outside
                    document.addEventListener('click', (e) => {
                        if (!this.$el.contains(e.target)) {
                            this.adminDropdownOpen = false;
                            this.profileDropdownOpen = false;
                        }
                    });
                    
                    // ESC key handler
                    document.addEventListener('keydown', (e) => {
                        if (e.key === 'Escape') {
                            this.closeAll();
                        }
                    });
                },
                
                closeAll() {
                    this.adminDropdownOpen = false;
                    this.profileDropdownOpen = false;
                    this.mobileMenuOpen = false;
                    console.log('üîí All dropdowns closed');
                },
                
                toggleAdminDropdown() {
                    this.adminDropdownOpen = !this.adminDropdownOpen;
                    this.profileDropdownOpen = false;
                    console.log('üîß Admin dropdown:', this.adminDropdownOpen);
                },
                
                toggleProfileDropdown() {
                    this.profileDropdownOpen = !this.profileDropdownOpen;
                    this.adminDropdownOpen = false;
                    console.log('üë§ Profile dropdown:', this.profileDropdownOpen);
                }
            }));
            
            console.log('‚úÖ NavigationData component registered');
        });
        
        document.addEventListener('alpine:initialized', () => {
            console.log('üéâ Alpine.js fully initialized!');
        });
        
        window.addEventListener('load', () => {
            console.log('üìÑ Page fully loaded');
            console.log('üîç Alpine available:', !!window.Alpine);
        });
    </script>
    <style>
        body { font-family: system-ui; padding: 2rem; }
        .container { max-width: 800px; margin: 0 auto; }
        .dropdown { position: relative; display: inline-block; margin: 1rem; }
        .dropdown-button { 
            background: #3b82f6; 
            color: white; 
            padding: 0.5rem 1rem; 
            border: none; 
            border-radius: 0.5rem;
            cursor: pointer;
        }
        .dropdown-button:hover { background: #2563eb; }
        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            min-width: 200px;
            z-index: 50;
        }
        .dropdown-item {
            display: block;
            padding: 0.5rem 1rem;
            color: #374151;
            text-decoration: none;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            cursor: pointer;
        }
        .dropdown-item:hover { background: #f3f4f6; }
        .debug-info { 
            background: #f3f4f6; 
            padding: 1rem; 
            border-radius: 0.5rem; 
            margin: 1rem 0;
            font-family: monospace;
        }
        [x-cloak] { display: none !important; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Alpine.js Dropdown Debug Test</h1>
        
        <div class="debug-info">
            <h3>Debug Info:</h3>
            <div id="debug-output">Loading...</div>
        </div>
        
        <div x-data="navigationData()">
            <h2>Test Dropdowns</h2>
            
            <!-- Admin Dropdown -->
            <div class="dropdown">
                <button class="dropdown-button" @click="toggleAdminDropdown()">
                    Admin Menu
                    <span x-text="adminDropdownOpen ? '‚ñ≤' : '‚ñº'"></span>
                </button>
                <div x-show="adminDropdownOpen" 
                     x-cloak
                     x-transition:enter="transition ease-out duration-200"
                     x-transition:enter-start="opacity-0 transform scale-95"
                     x-transition:enter-end="opacity-100 transform scale-100"
                     x-transition:leave="transition ease-in duration-150"
                     x-transition:leave-start="opacity-100 transform scale-100"
                     x-transition:leave-end="opacity-0 transform scale-95"
                     class="dropdown-menu"
                     @click="adminDropdownOpen = false">
                    <a href="#" class="dropdown-item">Dashboard</a>
                    <a href="#" class="dropdown-item">Users</a>
                    <a href="#" class="dropdown-item">Settings</a>
                </div>
            </div>
            
            <!-- Profile Dropdown -->
            <div class="dropdown">
                <button class="dropdown-button" @click="toggleProfileDropdown()">
                    Profile Menu
                    <span x-text="profileDropdownOpen ? '‚ñ≤' : '‚ñº'"></span>
                </button>
                <div x-show="profileDropdownOpen" 
                     x-cloak
                     x-transition:enter="transition ease-out duration-200"
                     x-transition:enter-start="opacity-0 transform scale-95"
                     x-transition:enter-end="opacity-100 transform scale-100"
                     x-transition:leave="transition ease-in duration-150"
                     x-transition:leave-start="opacity-100 transform scale-100"
                     x-transition:leave-end="opacity-0 transform scale-95"
                     class="dropdown-menu"
                     @click="profileDropdownOpen = false">
                    <a href="#" class="dropdown-item">View Profile</a>
                    <a href="#" class="dropdown-item">Edit Profile</a>
                    <a href="#" class="dropdown-item">Logout</a>
                </div>
            </div>
            
            <!-- Debug buttons -->
            <div style="margin-top: 2rem;">
                <button class="dropdown-button" @click="closeAll()" style="background: #ef4444;">
                    Close All Dropdowns
                </button>
            </div>
            
            <!-- State display -->
            <div class="debug-info">
                <h3>Current State:</h3>
                <div>Admin Dropdown: <span x-text="adminDropdownOpen ? 'OPEN' : 'CLOSED'" :class="adminDropdownOpen ? 'color: green;' : 'color: red;'"></span></div>
                <div>Profile Dropdown: <span x-text="profileDropdownOpen ? 'OPEN' : 'CLOSED'" :class="profileDropdownOpen ? 'color: green;' : 'color: red;'"></span></div>
            </div>
        </div>
        
        <div class="debug-info">
            <h3>Instructions:</h3>
            <ul>
                <li>Click "Admin Menu" or "Profile Menu" to open dropdowns</li>
                <li>Click outside the dropdown to close it</li>
                <li>Press ESC key to close all dropdowns</li>
                <li>Only one dropdown should be open at a time</li>
                <li>Check the browser console for debug messages</li>
            </ul>
        </div>
    </div>
    
    <script>
        // Update debug info
        function updateDebugInfo() {
            const debugOutput = document.getElementById('debug-output');
            debugOutput.innerHTML = `
                <div>Alpine.js loaded: ${!!window.Alpine}</div>
                <div>Current time: ${new Date().toLocaleTimeString()}</div>
                <div>User agent: ${navigator.userAgent.substring(0, 50)}...</div>
                <div>Screen size: ${window.innerWidth}x${window.innerHeight}</div>
            `;
        }
        
        // Update debug info every second
        setInterval(updateDebugInfo, 1000);
        updateDebugInfo();
    </script>
</body>
</html>
