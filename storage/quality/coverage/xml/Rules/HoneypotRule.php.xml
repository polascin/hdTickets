<?xml version="1.0"?>
<phpunit xmlns="https://schema.phpunit.de/coverage/1.0">
  <file name="HoneypotRule.php" path="/Rules">
    <totals>
      <lines total="46" comments="12" code="34" executable="13" executed="13" percent="100.00"/>
      <methods count="2" tested="2" percent="100.00"/>
      <functions count="0" tested="0" percent="0"/>
      <classes count="1" tested="1" percent="100.00"/>
      <traits count="0" tested="0" percent="0"/>
    </totals>
    <class name="App\Rules\HoneypotRule" start="15" executable="13" executed="13" crap="3">
      <namespace name="App\Rules"/>
      <method name="__construct" signature="__construct(string $fieldName)" start="17" end="20" crap="1" executable="1" executed="1" coverage="100"/>
      <method name="validate" signature="validate(string $attribute, mixed $value, Closure $fail): void" start="25" end="44" crap="2" executable="12" executed="12" coverage="100"/>
    </class>
    <coverage>
      <line nr="20">
        <covered by="Tests\Feature\AccessibilityTest::test_error_messages_have_proper_aria_attributes"/>
        <covered by="Tests\Feature\AccessibilityTest::test_form_validation_accessibility"/>
        <covered by="Tests\Feature\AccessibilityTest::test_error_recovery_accessibility"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_can_successfully_login_with_valid_credentials"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_rejects_invalid_credentials"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_locks_account_after_multiple_failed_attempts"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_rejects_login_for_locked_account"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_rejects_login_for_inactive_account"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_rejects_login_for_scraper_accounts"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_enforces_rate_limiting"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_handles_two_factor_authentication_redirect"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_handles_invalid_two_factor_codes"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_can_use_recovery_codes_for_two_factor"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_can_send_sms_backup_codes"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_can_send_email_backup_codes"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_validates_required_login_fields"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_validates_email_format"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_handles_honeypot_field"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_processes_device_fingerprinting"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_remembers_user_when_requested"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_clears_failed_attempts_on_successful_login"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_logs_successful_login_activity"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_redirects_to_intended_url_after_login"/>
        <covered by="Tests\Feature\Auth\LoginTest::user_can_login_with_valid_credentials"/>
        <covered by="Tests\Feature\Auth\LoginTest::user_cannot_login_with_invalid_email"/>
        <covered by="Tests\Feature\Auth\LoginTest::user_cannot_login_with_invalid_password"/>
        <covered by="Tests\Feature\Auth\LoginTest::user_cannot_login_with_empty_credentials"/>
        <covered by="Tests\Feature\Auth\LoginTest::user_cannot_login_with_invalid_email_format"/>
        <covered by="Tests\Feature\Auth\LoginTest::user_cannot_login_when_account_is_deactivated"/>
        <covered by="Tests\Feature\Auth\LoginTest::scraper_user_cannot_access_web_login"/>
        <covered by="Tests\Feature\Auth\LoginTest::user_account_gets_locked_after_failed_attempts"/>
        <covered by="Tests\Feature\Auth\LoginTest::user_cannot_login_when_account_is_locked"/>
        <covered by="Tests\Feature\Auth\LoginTest::user_can_login_after_lockout_expires"/>
        <covered by="Tests\Feature\Auth\LoginTest::failed_login_attempts_are_reset_after_successful_login"/>
        <covered by="Tests\Feature\Auth\LoginTest::login_is_rate_limited_per_ip"/>
        <covered by="Tests\Feature\Auth\LoginTest::remember_me_functionality_works"/>
        <covered by="Tests\Feature\Auth\LoginTest::honeypot_field_prevents_bot_submissions"/>
        <covered by="Tests\Feature\Auth\LoginTest::two_factor_enabled_user_is_redirected_to_2fa_challenge"/>
        <covered by="Tests\Feature\Auth\LoginTest::login_logs_successful_activity"/>
        <covered by="Tests\Feature\Auth\LoginTest::login_updates_user_login_metadata"/>
        <covered by="Tests\Feature\Auth\LoginTest::csrf_token_is_required_for_login"/>
        <covered by="Tests\Feature\Auth\LoginTest::device_fingerprinting_data_is_processed"/>
        <covered by="Tests\Feature\Auth\LoginTest::login_form_preserves_email_on_validation_failure"/>
        <covered by="Tests\Feature\Auth\LoginTest::redirect_after_login_works_correctly"/>
        <covered by="Tests\Feature\Auth\LoginTest::login_with_recaptcha_when_enabled"/>
        <covered by="Tests\Feature\Auth\LoginTest::login_fails_with_invalid_recaptcha"/>
        <covered by="Tests\Feature\Auth\LoginTest::enhanced_security_middleware_processes_requests"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_with_valid_credentials_succeeds"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_with_remember_me_sets_cookie"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_with_invalid_email_fails"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_with_invalid_password_fails"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_with_inactive_account_fails"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_with_locked_account_fails"/>
        <covered by="Tests\Feature\LoginValidationTest::test_account_locks_after_five_failed_attempts"/>
        <covered by="Tests\Feature\LoginValidationTest::test_failed_attempts_reset_on_successful_login"/>
        <covered by="Tests\Feature\LoginValidationTest::test_honeypot_protection_blocks_bots"/>
        <covered by="Tests\Feature\LoginValidationTest::test_csrf_protection_is_enforced"/>
        <covered by="Tests\Feature\LoginValidationTest::test_rate_limiting_prevents_brute_force"/>
        <covered by="Tests\Feature\LoginValidationTest::test_email_validation_rules"/>
        <covered by="Tests\Feature\LoginValidationTest::test_password_validation_rules"/>
        <covered by="Tests\Feature\LoginValidationTest::test_user_login_activity_logging"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_with_two_factor_authentication_enabled"/>
        <covered by="Tests\Feature\LoginValidationTest::test_scraper_users_cannot_login"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_session_regeneration"/>
      </line>
      <line nr="28">
        <covered by="Tests\Feature\AccessibilityTest::test_error_messages_have_proper_aria_attributes"/>
        <covered by="Tests\Feature\AccessibilityTest::test_form_validation_accessibility"/>
        <covered by="Tests\Feature\AccessibilityTest::test_error_recovery_accessibility"/>
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_handles_honeypot_field"/>
        <covered by="Tests\Feature\Auth\LoginTest::honeypot_field_prevents_bot_submissions"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_with_valid_credentials_succeeds"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_with_remember_me_sets_cookie"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_with_invalid_email_fails"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_with_invalid_password_fails"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_with_inactive_account_fails"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_with_locked_account_fails"/>
        <covered by="Tests\Feature\LoginValidationTest::test_account_locks_after_five_failed_attempts"/>
        <covered by="Tests\Feature\LoginValidationTest::test_failed_attempts_reset_on_successful_login"/>
        <covered by="Tests\Feature\LoginValidationTest::test_honeypot_protection_blocks_bots"/>
        <covered by="Tests\Feature\LoginValidationTest::test_csrf_protection_is_enforced"/>
        <covered by="Tests\Feature\LoginValidationTest::test_rate_limiting_prevents_brute_force"/>
        <covered by="Tests\Feature\LoginValidationTest::test_email_validation_rules"/>
        <covered by="Tests\Feature\LoginValidationTest::test_password_validation_rules"/>
        <covered by="Tests\Feature\LoginValidationTest::test_user_login_activity_logging"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_with_two_factor_authentication_enabled"/>
        <covered by="Tests\Feature\LoginValidationTest::test_scraper_users_cannot_login"/>
        <covered by="Tests\Feature\LoginValidationTest::test_login_session_regeneration"/>
      </line>
      <line nr="30">
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_handles_honeypot_field"/>
        <covered by="Tests\Feature\Auth\LoginTest::honeypot_field_prevents_bot_submissions"/>
        <covered by="Tests\Feature\LoginValidationTest::test_honeypot_protection_blocks_bots"/>
      </line>
      <line nr="31">
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_handles_honeypot_field"/>
        <covered by="Tests\Feature\Auth\LoginTest::honeypot_field_prevents_bot_submissions"/>
        <covered by="Tests\Feature\LoginValidationTest::test_honeypot_protection_blocks_bots"/>
      </line>
      <line nr="32">
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_handles_honeypot_field"/>
        <covered by="Tests\Feature\Auth\LoginTest::honeypot_field_prevents_bot_submissions"/>
        <covered by="Tests\Feature\LoginValidationTest::test_honeypot_protection_blocks_bots"/>
      </line>
      <line nr="33">
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_handles_honeypot_field"/>
        <covered by="Tests\Feature\Auth\LoginTest::honeypot_field_prevents_bot_submissions"/>
        <covered by="Tests\Feature\LoginValidationTest::test_honeypot_protection_blocks_bots"/>
      </line>
      <line nr="34">
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_handles_honeypot_field"/>
        <covered by="Tests\Feature\Auth\LoginTest::honeypot_field_prevents_bot_submissions"/>
        <covered by="Tests\Feature\LoginValidationTest::test_honeypot_protection_blocks_bots"/>
      </line>
      <line nr="35">
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_handles_honeypot_field"/>
        <covered by="Tests\Feature\Auth\LoginTest::honeypot_field_prevents_bot_submissions"/>
        <covered by="Tests\Feature\LoginValidationTest::test_honeypot_protection_blocks_bots"/>
      </line>
      <line nr="36">
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_handles_honeypot_field"/>
        <covered by="Tests\Feature\Auth\LoginTest::honeypot_field_prevents_bot_submissions"/>
        <covered by="Tests\Feature\LoginValidationTest::test_honeypot_protection_blocks_bots"/>
      </line>
      <line nr="37">
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_handles_honeypot_field"/>
        <covered by="Tests\Feature\Auth\LoginTest::honeypot_field_prevents_bot_submissions"/>
        <covered by="Tests\Feature\LoginValidationTest::test_honeypot_protection_blocks_bots"/>
      </line>
      <line nr="38">
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_handles_honeypot_field"/>
        <covered by="Tests\Feature\Auth\LoginTest::honeypot_field_prevents_bot_submissions"/>
        <covered by="Tests\Feature\LoginValidationTest::test_honeypot_protection_blocks_bots"/>
      </line>
      <line nr="42">
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_handles_honeypot_field"/>
        <covered by="Tests\Feature\Auth\LoginTest::honeypot_field_prevents_bot_submissions"/>
        <covered by="Tests\Feature\LoginValidationTest::test_honeypot_protection_blocks_bots"/>
      </line>
      <line nr="39">
        <covered by="Tests\Feature\Auth\EnhancedLoginTest::it_handles_honeypot_field"/>
        <covered by="Tests\Feature\Auth\LoginTest::honeypot_field_prevents_bot_submissions"/>
        <covered by="Tests\Feature\LoginValidationTest::test_honeypot_protection_blocks_bots"/>
      </line>
    </coverage>
    <source>
      <line no="1">
        <token name="T_OPEN_TAG">&lt;?php </token>
        <token name="T_DECLARE">declare</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_STRING">strict_types</token>
        <token name="T_EQUAL">=</token>
        <token name="T_LNUMBER">1</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_SEMICOLON">;</token>
      </line>
      <line no="2"/>
      <line no="3">
        <token name="T_NAMESPACE">namespace</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_NAME_QUALIFIED">App\Rules</token>
        <token name="T_SEMICOLON">;</token>
      </line>
      <line no="4"/>
      <line no="5">
        <token name="T_USE">use</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_STRING">Closure</token>
        <token name="T_SEMICOLON">;</token>
      </line>
      <line no="6">
        <token name="T_USE">use</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_NAME_QUALIFIED">Illuminate\Contracts\Validation\ValidationRule</token>
        <token name="T_SEMICOLON">;</token>
      </line>
      <line no="7">
        <token name="T_USE">use</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_NAME_QUALIFIED">Illuminate\Support\Facades\Log</token>
        <token name="T_SEMICOLON">;</token>
      </line>
      <line no="8"/>
      <line no="9">
        <token name="T_DOC_COMMENT">/**</token>
      </line>
      <line no="10">
        <token name="T_DOC_COMMENT"> * Honeypot Validation Rule</token>
      </line>
      <line no="11">
        <token name="T_DOC_COMMENT"> *</token>
      </line>
      <line no="12">
        <token name="T_DOC_COMMENT"> * Validates that honeypot fields remain empty to detect bot submissions.</token>
      </line>
      <line no="13">
        <token name="T_DOC_COMMENT"> * When triggered, logs the potential bot activity for security monitoring.</token>
      </line>
      <line no="14">
        <token name="T_DOC_COMMENT"> */</token>
      </line>
      <line no="15">
        <token name="T_CLASS">class</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_STRING">HoneypotRule</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_IMPLEMENTS">implements</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_STRING">ValidationRule</token>
      </line>
      <line no="16">
        <token name="T_OPEN_CURLY">{</token>
      </line>
      <line no="17">
        <token name="T_WHITESPACE">    </token>
        <token name="T_PUBLIC">public</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_FUNCTION">function</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_STRING">__construct</token>
        <token name="T_OPEN_BRACKET">(</token>
      </line>
      <line no="18">
        <token name="T_WHITESPACE">        </token>
        <token name="T_PRIVATE">private</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_STRING">string</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_VARIABLE">$fieldName</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_EQUAL">=</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_CONSTANT_ENCAPSED_STRING">'honeypot'</token>
        <token name="T_COMMA">,</token>
      </line>
      <line no="19">
        <token name="T_WHITESPACE">    </token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_OPEN_CURLY">{</token>
      </line>
      <line no="20">
        <token name="T_WHITESPACE">    </token>
        <token name="T_CLOSE_CURLY">}</token>
      </line>
      <line no="21"/>
      <line no="22">
        <token name="T_WHITESPACE">    </token>
        <token name="T_DOC_COMMENT">/**</token>
      </line>
      <line no="23">
        <token name="T_DOC_COMMENT">     * Run the validation rule.</token>
      </line>
      <line no="24">
        <token name="T_DOC_COMMENT">     */</token>
      </line>
      <line no="25">
        <token name="T_WHITESPACE">    </token>
        <token name="T_PUBLIC">public</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_FUNCTION">function</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_STRING">validate</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_STRING">string</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_VARIABLE">$attribute</token>
        <token name="T_COMMA">,</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_STRING">mixed</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_VARIABLE">$value</token>
        <token name="T_COMMA">,</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_STRING">Closure</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_VARIABLE">$fail</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_COLON">:</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_STRING">void</token>
      </line>
      <line no="26">
        <token name="T_WHITESPACE">    </token>
        <token name="T_OPEN_CURLY">{</token>
      </line>
      <line no="27">
        <token name="T_WHITESPACE">        </token>
        <token name="T_COMMENT">// Honeypot field should always be empty</token>
      </line>
      <line no="28">
        <token name="T_WHITESPACE">        </token>
        <token name="T_IF">if</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_EXCLAMATION_MARK">!</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_EMPTY">empty</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_VARIABLE">$value</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_OPEN_CURLY">{</token>
      </line>
      <line no="29">
        <token name="T_WHITESPACE">            </token>
        <token name="T_COMMENT">// Log potential bot activity</token>
      </line>
      <line no="30">
        <token name="T_WHITESPACE">            </token>
        <token name="T_STRING">Log</token>
        <token name="T_DOUBLE_COLON">::</token>
        <token name="T_STRING">channel</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_CONSTANT_ENCAPSED_STRING">'security'</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_OBJECT_OPERATOR">-&gt;</token>
        <token name="T_STRING">warning</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_CONSTANT_ENCAPSED_STRING">'Potential bot detected: Honeypot field filled'</token>
        <token name="T_COMMA">,</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_OPEN_SQUARE">[</token>
      </line>
      <line no="31">
        <token name="T_WHITESPACE">                </token>
        <token name="T_CONSTANT_ENCAPSED_STRING">'honeypot_field'</token>
        <token name="T_WHITESPACE">  </token>
        <token name="T_DOUBLE_ARROW">=&gt;</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_VARIABLE">$this</token>
        <token name="T_OBJECT_OPERATOR">-&gt;</token>
        <token name="T_STRING">fieldName</token>
        <token name="T_COMMA">,</token>
      </line>
      <line no="32">
        <token name="T_WHITESPACE">                </token>
        <token name="T_CONSTANT_ENCAPSED_STRING">'submitted_field'</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_DOUBLE_ARROW">=&gt;</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_VARIABLE">$attribute</token>
        <token name="T_COMMA">,</token>
      </line>
      <line no="33">
        <token name="T_WHITESPACE">                </token>
        <token name="T_CONSTANT_ENCAPSED_STRING">'value'</token>
        <token name="T_WHITESPACE">           </token>
        <token name="T_DOUBLE_ARROW">=&gt;</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_VARIABLE">$value</token>
        <token name="T_COMMA">,</token>
      </line>
      <line no="34">
        <token name="T_WHITESPACE">                </token>
        <token name="T_CONSTANT_ENCAPSED_STRING">'ip'</token>
        <token name="T_WHITESPACE">              </token>
        <token name="T_DOUBLE_ARROW">=&gt;</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_STRING">request</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_OBJECT_OPERATOR">-&gt;</token>
        <token name="T_STRING">ip</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_COMMA">,</token>
      </line>
      <line no="35">
        <token name="T_WHITESPACE">                </token>
        <token name="T_CONSTANT_ENCAPSED_STRING">'user_agent'</token>
        <token name="T_WHITESPACE">      </token>
        <token name="T_DOUBLE_ARROW">=&gt;</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_STRING">request</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_OBJECT_OPERATOR">-&gt;</token>
        <token name="T_STRING">userAgent</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_COMMA">,</token>
      </line>
      <line no="36">
        <token name="T_WHITESPACE">                </token>
        <token name="T_CONSTANT_ENCAPSED_STRING">'url'</token>
        <token name="T_WHITESPACE">             </token>
        <token name="T_DOUBLE_ARROW">=&gt;</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_STRING">request</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_OBJECT_OPERATOR">-&gt;</token>
        <token name="T_STRING">fullUrl</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_COMMA">,</token>
      </line>
      <line no="37">
        <token name="T_WHITESPACE">                </token>
        <token name="T_CONSTANT_ENCAPSED_STRING">'session_id'</token>
        <token name="T_WHITESPACE">      </token>
        <token name="T_DOUBLE_ARROW">=&gt;</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_STRING">request</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_OBJECT_OPERATOR">-&gt;</token>
        <token name="T_STRING">session</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_OBJECT_OPERATOR">-&gt;</token>
        <token name="T_STRING">getId</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_COMMA">,</token>
      </line>
      <line no="38">
        <token name="T_WHITESPACE">                </token>
        <token name="T_CONSTANT_ENCAPSED_STRING">'timestamp'</token>
        <token name="T_WHITESPACE">       </token>
        <token name="T_DOUBLE_ARROW">=&gt;</token>
        <token name="T_WHITESPACE"> </token>
        <token name="T_STRING">now</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_OBJECT_OPERATOR">-&gt;</token>
        <token name="T_STRING">toISOString</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_COMMA">,</token>
      </line>
      <line no="39">
        <token name="T_WHITESPACE">            </token>
        <token name="T_CLOSE_SQUARE">]</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_SEMICOLON">;</token>
      </line>
      <line no="40"/>
      <line no="41">
        <token name="T_WHITESPACE">            </token>
        <token name="T_COMMENT">// Fail validation with a generic message</token>
      </line>
      <line no="42">
        <token name="T_WHITESPACE">            </token>
        <token name="T_VARIABLE">$fail</token>
        <token name="T_OPEN_BRACKET">(</token>
        <token name="T_CONSTANT_ENCAPSED_STRING">'Invalid form submission detected.'</token>
        <token name="T_CLOSE_BRACKET">)</token>
        <token name="T_SEMICOLON">;</token>
      </line>
      <line no="43">
        <token name="T_WHITESPACE">        </token>
        <token name="T_CLOSE_CURLY">}</token>
      </line>
      <line no="44">
        <token name="T_WHITESPACE">    </token>
        <token name="T_CLOSE_CURLY">}</token>
      </line>
      <line no="45">
        <token name="T_CLOSE_CURLY">}</token>
      </line>
      <line no="46"/>
    </source>
  </file>
</phpunit>
